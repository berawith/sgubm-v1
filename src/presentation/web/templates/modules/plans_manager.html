<!-- Plans Manager Module -->
<div id="plans-view" class="content-view">
    <div class="view-header">
        <div class="header-left">
            <h1 class="page-title">Planes de Internet</h1>
            <p class="page-subtitle">Configuraci칩n centralizada de velocidades y precios</p>
        </div>
        <button class="btn-primary" onclick="window.openPlanModal()">
            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"
                style="margin-right:8px">
                <path d="M12 5v14M5 12h14" />
            </svg>
            Nuevo Plan
        </button>
    </div>

    <!-- Stats Row -->
    <div class="metrics-row" style="margin-bottom: 24px;">
        <div class="metric-card">
            <div class="icon"
                style="background: rgba(59, 130, 246, 0.1); color: #3b82f6; display: flex; align-items: center; justify-content: center; border-radius: 8px;">
                <i class="fas fa-layer-group"></i>
            </div>
            <span class="stat-label">Total Planes</span>
            <span class="stat-value" id="totalPlans">--</span>
        </div>
    </div>

    <!-- Plans Table Container -->
    <div class="bg-white/70 backdrop-blur-xl rounded-2xl shadow-sm border border-white/50 overflow-hidden"
        style="background: white; border-radius: 16px; border: 1px solid #e2e8f0; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);">
        <table class="data-table" style="margin-top: 0; border: none; box-shadow: none;">
            <thead>
                <tr>
                    <th style="padding-left: 24px;" class="sortable" onclick="window.sortPlansBy('name')">Nombre del
                        Plan <i class="fas fa-sort"></i></th>
                    <th class="sortable" onclick="window.sortPlansBy('download_speed')">Velocidad (Mbps) <i
                            class="fas fa-sort"></i></th>
                    <th class="sortable" onclick="window.sortPlansBy('monthly_price')">Precio Tarifa <i
                            class="fas fa-sort"></i></th>
                    <th class="sortable" onclick="window.sortPlansBy('router_name')">Asignado a <i
                            class="fas fa-sort"></i></th>
                    <th class="sortable" onclick="window.sortPlansBy('service_type')">Servicio <i
                            class="fas fa-sort"></i></th>
                    <th class="sortable" onclick="window.sortPlansBy('clients_count')">Clientes <i
                            class="fas fa-sort"></i></th>
                    <th style="text-align: right; padding-right: 24px;">Acciones</th>
                </tr>
            </thead>
            <tbody id="plansTableBody">
                <!-- Dynamic Rows -->
            </tbody>
        </table>
        <!-- Vista de Tarjetas (M칩vil) -->
        <div id="plans-cards-grid" class="plans-cards-grid">
            <!-- Rendered by JS -->
        </div>
    </div>

    <!-- Plan Clients Modal -->
    <div id="planClientsModal" class="modal">
        <div class="modal-content large-modal" style="max-width: 1000px;">
            <div class="modal-header-compact" style="flex-wrap: wrap; gap: 15px;">
                <div class="header-bg-glow"></div>
                <div class="header-content-row" style="flex-shrink: 0;">
                    <div class="header-icon-box">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="header-titles">
                        <h3 id="planClientsModalTitle">Clientes del Plan</h3>
                        <p id="planClientsModalSubtitle" class="modal-subtitle-text">MONITOREO DE PLAN</p>
                    </div>
                </div>

                <!-- Search Input -->
                <div
                    style="flex: 1; min-width: 250px; display: flex; justify-content: flex-end; align-items: center; padding: 0 10px;">
                    <div style="position: relative; width: 100%; max-width: 400px;">
                        <i class="fas fa-search"
                            style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: #94a3b8;"></i>
                        <input type="text" id="plan-clients-search" placeholder="Buscar cliente por nombre o c칩digo..."
                            style="width: 100%; padding: 8px 12px 8px 36px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 0.85rem; outline: none; transition: all 0.2s;"
                            onfocus="this.style.borderColor='#6366f1'; this.style.boxShadow='0 0 0 3px rgba(99,102,241,0.1)'"
                            onblur="this.style.borderColor='#e2e8f0'; this.style.boxShadow='none'">
                    </div>
                </div>

                <button class="close-btn-compact" onclick="window.closePlanClientsModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="modal-body-compact" style="padding: 24px;">
                <div id="planClientsList" class="premium-cards-grid"
                    style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 16px; max-height: 70vh; overflow-y: auto; padding: 4px;">
                    <!-- Renderizado din치mico de tarjetas -->
                    <div class="loading-cell" style="grid-column: 1/-1; text-align: center; padding: 40px;">
                        <div class="spinner"></div>
                        <p style="margin-top: 15px; color: #64748b;">Cargando listado de clientes...</p>
                    </div>
                </div>

                <div id="planClientsEmpty" style="display: none; padding: 40px; text-align: center; color: #94a3b8;">
                    <i class="fas fa-users-slash"
                        style="font-size: 2rem; margin-bottom: 10px; display: block; opacity: 0.5;"></i>
                    No hay clientes asignados a este plan.
                </div>
            </div>

            <div class="modal-footer-compact">
                <div id="plan-clients-count-badge" class="status-badge secondary" style="margin-right: auto;">0 Clientes
                </div>
                <button type="button" class="btn-ghost-compact" onclick="window.closePlanClientsModal()">Cerrar
                    Vista</button>
            </div>
        </div>
    </div>
</div>