<!-- REPORTS VIEW (WITH STATISTICS) -->
<div id="reports-view" class="view content-view" style="display: none;">
    <style>
        #report-data-table {
            border-collapse: collapse !important;
            width: 100% !important;
        }

        #report-data-table td {
            padding: 1px 4px !important;
            height: 24px !important;
            vertical-align: middle !important;
            border-bottom: 1px solid #f1f5f9 !important;
        }

        #report-data-table th {
            padding: 4px 6px !important;
            font-size: 0.6rem !important;
        }

        .premium-row {
            height: auto !important;
            min-height: 0 !important;
        }

        .client-report-checkbox {
            transform: scale(0.8) !important;
            margin: 0 !important;
        }

        @media print {
            body {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            .printable-report {
                padding: 0 !important;
                background: transparent !important;
                box-shadow: none !important;
            }

            #report-detailed-analysis>div {
                border: 1px solid #cbd5e1 !important;
                box-shadow: none !important;
            }

            #status-chart-container {
                height: 200px !important;
                /* Slightly larger for print */
                page-break-inside: avoid;
            }

            /* Ensure grids don't collapse too much */
            div[style*="display: grid"] {
                display: flex !important;
                flex-wrap: wrap !important;
                gap: 15px !important;
            }

            div[style*="grid-template-columns: 1fr 1fr"]>div {
                flex: 1 1 45% !important;
            }

            /* Summary Cards in Print */
            div[style*="grid-template-columns: repeat(auto-fit"]>div {
                flex: 1 1 20% !important;
                min-width: 150px !important;
                border: 1px solid #e2e8f0 !important;
                background-color: #f8fafc !important;
                /* Force background */
            }

            /* Fix Analysis Text in Print */
            #report-detailed-analysis p {
                font-size: 9pt !important;
                color: #1e293b !important;
            }

            .no-print {
                display: none !important;
            }
        }
    </style>

    <!-- Unified Premium Header & Control Center (Hidden on Print) -->
    <div class="no-print"
        style="background: white; border: 1px solid #e2e8f0; border-radius: 10px; padding: 10px 15px; margin-bottom: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.03); position: relative; z-index: 100;">

        <!-- View Title Section + Action Buttons -->
        <div
            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; padding-bottom: 8px; border-bottom: 1px solid #f1f5f9;">
            <div style="display: flex; flex-direction: column;">
                <div style="display: flex; align-items: baseline; gap: 10px;">
                    <h1 style="margin: 0; font-size: 1rem; font-weight: 900; color: #0f172a; letter-spacing: -0.01em;">
                        Reportes</h1>
                    <p style="margin: 0; color: #94a3b8; font-size: 0.65rem; font-weight: 500;">Auditoría y Recaudación
                    </p>
                </div>
                <!-- Screen Stats Container -->
                <div id="report-screen-stats" style="display: none; gap: 15px; margin-top: 15px;"></div>
            </div>

            <!-- Global Action Bar -->
            <div style="display: flex; gap: 6px; align-items: center;">
                <!-- Financial OK -->
                <button class="btn-primary" onclick="app.modules.payments.loadAdvancedFinancialReport()"
                    style="height: 28px; padding: 0 12px; border-radius: 6px; font-size: 0.7rem; font-weight: 800; background: #6366f1; color: white; border: none; cursor: pointer; display: flex; align-items: center; gap: 5px;">
                    <i class="fas fa-chart-pie"></i> ANALIZAR FINANZAS
                </button>

                <!-- Audit LISTAR -->
                <button class="btn-primary" onclick="app.modules.payments.loadClientsStatusReport()"
                    style="height: 28px; padding: 0 12px; border-radius: 6px; font-size: 0.7rem; font-weight: 800; background: #10b981; color: white; border: none; cursor: pointer; display: flex; align-items: center; gap: 5px;">
                    <i class="fas fa-list-ul"></i> GENERAR LISTADO
                </button>

                <!-- Print Button -->
                <button class="btn-secondary" onclick="window.print()"
                    style="height: 28px; padding: 0 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 700; background: #f8fafc; border: 1px solid #e2e8f0; color: #475569; display: flex; align-items: center; gap: 5px; transition: all 0.2s;">
                    <i class="fas fa-print"></i> Imprimir
                </button>
            </div>
        </div>

        <!-- Toolbar Section (Filters only) -->
        <div class="clients-toolbar" style="display: flex; gap: 8px; flex-wrap: wrap; align-items: center;">

            <!-- Global Filters (Router) -->
            <div class="filter-item"
                style="flex: 1.2; min-width: 150px; background: #f8fafc; padding: 4px 10px; border-radius: 8px; border: 1px solid #f1f5f9; display: flex; align-items: center; gap: 8px;">
                <label style="white-space: nowrap; font-weight: 850; color: #475569; text-transform: uppercase;">
                    <i class="fas fa-server"></i> Router:
                </label>
                <select id="report-router-id" class="select-premium"
                    style="flex: 1; border-radius: 6px; border: 1px solid #e2e8f0; font-weight: 700;">
                    <option value="">TODOS (Gen)</option>
                </select>
            </div>

            <!-- Financial Analysis Control -->
            <div class="filter-item"
                style="flex: 1; min-width: 150px; background: #f8fafc; padding: 4px 10px; border-radius: 8px; border: 1px solid #f1f5f9; display: flex; align-items: center; gap: 8px;">
                <label style="white-space: nowrap; font-weight: 850; color: #6366f1; text-transform: uppercase;">
                    <i class="fas fa-calendar-alt"></i> Periodo:
                </label>
                <select id="report-financial-period" class="select-premium"
                    style="flex: 1; border-radius: 6px; border: 1px solid #e2e8f0; font-weight: 700;">
                    <option value="annual" selected>Balance Anual</option>
                    <option value="semester">Semestral</option>
                    <option value="quarter">Trimestral</option>
                </select>
            </div>

            <!-- Auditor Lists Control -->
            <div class="filter-item"
                style="flex: 2; min-width: 250px; background: #f8fafc; padding: 4px 10px; border-radius: 8px; border: 1px solid #f1f5f9; display: flex; align-items: center; gap: 8px;">
                <label style="white-space: nowrap; font-weight: 850; color: #10b981; text-transform: uppercase;">
                    <i class="fas fa-filter"></i> Auditoría:
                </label>
                <div style="display: flex; gap: 5px; align-items: center; flex: 1;">
                    <select id="report-client-type" class="select-premium"
                        style="flex: 1.5; border-radius: 6px; border: 1px solid #e2e8f0; font-weight: 700;">
                        <option value="paid">Día</option>
                        <option value="missing">Faltas</option>
                        <option value="debtors" selected>Morosos</option>
                        <option value="deleted">Papelera</option>
                    </select>
                    <select id="report-audit-day" class="select-premium"
                        style="width: 55px; border-radius: 6px; border: 1px solid #e2e8f0; font-weight: 700;">
                        <option value="">Hoy</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                        <option value="13">13</option>
                        <option value="14">14</option>
                        <option value="15">15</option>
                        <option value="16">16</option>
                        <option value="17">17</option>
                        <option value="18">18</option>
                        <option value="19">19</option>
                        <option value="20">20</option>
                        <option value="21">21</option>
                        <option value="22">22</option>
                        <option value="23">23</option>
                        <option value="24">24</option>
                        <option value="25">25</option>
                        <option value="26">26</option>
                        <option value="27">27</option>
                        <option value="28">28</option>
                        <option value="29">29</option>
                        <option value="30">30</option>
                        <option value="31">31</option>
                    </select>
                    <select id="report-audit-month" class="select-premium"
                        style="flex: 1; border-radius: 6px; border: 1px solid #e2e8f0; font-weight: 700;">
                        <option value="1">Ene</option>
                        <option value="2">Feb</option>
                        <option value="3">Mar</option>
                        <option value="4">Abr</option>
                        <option value="5">May</option>
                        <option value="6">Jun</option>
                        <option value="7">Jul</option>
                        <option value="8">Ago</option>
                        <option value="9">Sep</option>
                        <option value="10">Oct</option>
                        <option value="11">Nov</option>
                        <option value="12">Dic</option>
                    </select>
                    <select id="report-audit-year" class="select-premium"
                        style="width: 70px; border-radius: 6px; border: 1px solid #e2e8f0; font-weight: 700;">
                        <option value="2024">24</option>
                        <option value="2025">25</option>
                        <option value="2026" selected>26</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <!-- Elegant Print Header (Only visible on Print) -->
    <div class="print-header">
        <div style="padding-bottom: 20px; margin-bottom: 30px; text-align: center;">
            <p id="print-report-title"
                style="margin: 0; font-size: 18pt; color: #0f172a; font-weight: 950; text-transform: uppercase; letter-spacing: 2px;">
            </p>
            <div style="width: 80px; height: 4px; background: #6366f1; margin: 15px auto;"></div>
            <p style="margin: 5px 0 0 0; font-size: 10pt; color: #64748b; font-weight: 600;">GENERADO EL: <span
                    id="print-current-date"></span></p>

            <!-- New Print Stats Header -->
            <div id="print-stats-header" style="display: flex; gap: 20px; justify-content: center; margin-top: 15px;">
            </div>
        </div>
    </div>

    <!-- Results Section -->
    <div id="report-results-container" class="printable-report"
        style="padding: 15px; background: white; border-radius: 12px; min-height: 400px; margin-bottom: 24px;">

        <div id="report-initial-placeholder" class="no-print"
            style="text-align: center; padding: 80px 0; color: #94a3b8;">
            <i class="fas fa-file-invoice-dollar"
                style="font-size: 3rem; opacity: 0.2; margin-bottom: 15px; display: block;"></i>
            <h4 style="font-weight: 700; color: #64748b;">Seleccione un reporte para analizar</h4>
            <p style="font-size: 0.8rem;">Los resultados se mostrarán listos para impresión.</p>
        </div>

        <div id="report-data-content" style="display: none;">
            <div id="report-table-header" style="margin-bottom: 15px;"></div>

            <div class="table-responsive-premium">
                <table class="premium-table" id="report-data-table" style="width: 100%; border-collapse: collapse;">
                    <thead id="report-table-head"></thead>
                    <tbody id="report-table-body"></tbody>
                </table>
            </div>

            <div id="report-footer-stats" style="margin-top: 20px; padding-top: 15px;"></div>
        </div>
    </div>

</div>